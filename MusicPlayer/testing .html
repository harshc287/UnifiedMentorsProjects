<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Enhanced Music Player</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      color: #ffffff;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 20px;
      transition: background 0.8s cubic-bezier(0.25, 0.46, 0.45, 0.94);
    }

    .player-container {
      width: 100%;
      max-width: 450px;
      background: rgba(255, 255, 255, 0.1);
      backdrop-filter: blur(20px);
      border: 1px solid rgba(255, 255, 255, 0.2);
      border-radius: 24px;
      padding: 32px;
      box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
    }

    .now-playing {
      text-align: center;
      font-size: 12px;
      font-weight: 600;
      letter-spacing: 2px;
      opacity: 0.7;
      margin-bottom: 24px;
      text-transform: uppercase;
    }

    .track-art {
      width: 280px;
      height: 280px;
      margin: 0 auto 24px;
      border-radius: 20px;
      background-size: cover;
      background-position: center;
      box-shadow: 0 15px 35px rgba(0, 0, 0, 0.4);
      position: relative;
      overflow: hidden;
      transition: all 0.5s ease;
    }

    .track-art::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(45deg, transparent, rgba(255, 255, 255, 0.1));
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .track-art:hover::before {
      opacity: 1;
    }

    .track-info {
      text-align: center;
      margin-bottom: 32px;
    }

    .track-name {
      font-size: 24px;
      font-weight: 700;
      margin-bottom: 8px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.3);
    }

    .track-artist {
      font-size: 16px;
      opacity: 0.8;
      font-weight: 400;
    }

    .controls {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 32px;
      margin-bottom: 32px;
    }

    .control-btn {
      background: none;
      border: none;
      color: white;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      border-radius: 50%;
    }

    .control-btn:hover {
      transform: scale(1.1);
      text-shadow: 0 0 20px currentColor;
    }

    .play-pause {
      width: 70px;
      height: 70px;
      background: rgba(255, 255, 255, 0.15);
      backdrop-filter: blur(10px);
      border: 2px solid rgba(255, 255, 255, 0.3);
    }

    .play-pause:hover {
      background: rgba(255, 255, 255, 0.25);
      transform: scale(1.05);
    }

    .progress-section {
      margin-bottom: 24px;
    }

    .progress-container {
      position: relative;
      margin-bottom: 12px;
    }

    .seek-slider {
      -webkit-appearance: none;
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: rgba(255, 255, 255, 0.3);
      outline: none;
      cursor: pointer;
    }

    .seek-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 18px;
      height: 18px;
      border-radius: 50%;
      background: #ffffff;
      box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .seek-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
      box-shadow: 0 4px 15px rgba(255, 255, 255, 0.4);
    }

    .time-info {
      display: flex;
      justify-content: space-between;
      font-size: 12px;
      opacity: 0.8;
      font-weight: 500;
    }

    .volume-section {
      display: flex;
      align-items: center;
      gap: 16px;
      margin-bottom: 32px;
    }

    .volume-slider {
      -webkit-appearance: none;
      flex: 1;
      height: 4px;
      border-radius: 2px;
      background: rgba(255, 255, 255, 0.3);
      outline: none;
    }

    .volume-slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: #ffffff;
      cursor: pointer;
      transition: all 0.2s ease;
    }

    .volume-slider::-webkit-slider-thumb:hover {
      transform: scale(1.2);
    }

    .file-upload {
      margin-bottom: 24px;
    }

    .upload-btn {
      width: 100%;
      padding: 16px;
      background: rgba(255, 255, 255, 0.1);
      border: 2px dashed rgba(255, 255, 255, 0.4);
      border-radius: 12px;
      color: white;
      font-size: 14px;
      cursor: pointer;
      transition: all 0.3s ease;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 12px;
    }

    .upload-btn:hover, .upload-btn.dragover {
      background: rgba(255, 255, 255, 0.2);
      border-color: rgba(255, 255, 255, 0.6);
      transform: translateY(-2px);
    }

    .file-input {
      display: none;
    }

    .playlist {
      max-height: 300px;
      overflow-y: auto;
      border-radius: 12px;
      background: rgba(0, 0, 0, 0.2);
      backdrop-filter: blur(10px);
    }

    .playlist::-webkit-scrollbar {
      width: 6px;
    }

    .playlist::-webkit-scrollbar-track {
      background: rgba(255, 255, 255, 0.1);
      border-radius: 3px;
    }

    .playlist::-webkit-scrollbar-thumb {
      background: rgba(255, 255, 255, 0.4);
      border-radius: 3px;
    }

    .playlist-item {
      display: flex;
      align-items: center;
      padding: 16px 20px;
      cursor: pointer;
      transition: all 0.3s ease;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
    }

    .playlist-item:last-child {
      border-bottom: none;
    }

    .playlist-item:hover {
      background: rgba(255, 255, 255, 0.1);
      transform: translateX(4px);
    }

    .playlist-item.active {
      background: rgba(255, 255, 255, 0.15);
      border-left: 4px solid #ffffff;
    }

    .track-info-mini {
      flex: 1;
    }

    .track-title {
      font-weight: 600;
      font-size: 14px;
      margin-bottom: 4px;
    }

    .track-artist-mini {
      font-size: 12px;
      opacity: 0.7;
    }

    .playlist-controls {
      display: flex;
      gap: 8px;
    }

    .playlist-btn {
      background: none;
      border: none;
      color: rgba(255, 255, 255, 0.7);
      cursor: pointer;
      padding: 8px;
      border-radius: 6px;
      transition: all 0.2s ease;
      font-size: 12px;
    }

    .playlist-btn:hover {
      background: rgba(255, 255, 255, 0.1);
      color: white;
      transform: scale(1.1);
    }

    .empty-state {
      text-align: center;
      padding: 40px 20px;
      opacity: 0.6;
    }

    .empty-state i {
      font-size: 48px;
      margin-bottom: 16px;
      opacity: 0.5;
    }

    @media (max-width: 500px) {
      .player-container {
        padding: 24px;
        margin: 10px;
      }

      .track-art {
        width: 220px;
        height: 220px;
      }

      .controls {
        gap: 24px;
      }

      .play-pause {
        width: 60px;
        height: 60px;
      }

      .track-name {
        font-size: 20px;
      }
    }

    .visualizer {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: linear-gradient(90deg, #ff6b6b, #4ecdc4, #45b7d1, #96ceb4);
      background-size: 200% 100%;
      animation: gradient-shift 3s ease infinite;
      opacity: 0;
      transition: opacity 0.3s ease;
    }

    .visualizer.playing {
      opacity: 0.8;
    }

    @keyframes gradient-shift {
      0%, 100% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
    }

    .loading {
      opacity: 0.5;
      pointer-events: none;
    }
  </style>
</head>
<body>
  <div class="player-container">
    <div class="now-playing">Playing 1 of 3</div>
    
    <div class="track-art"></div>
    
    <div class="track-info">
      <div class="track-name">Select a track to play</div>
      <div class="track-artist">No artist</div>
    </div>

    <div class="controls">
      <button class="control-btn prev-btn" title="Previous">
        <i class="fas fa-step-backward fa-lg"></i>
      </button>
      
      <button class="control-btn play-pause" title="Play/Pause">
        <i class="fas fa-play fa-xl"></i>
      </button>
      
      <button class="control-btn next-btn" title="Next">
        <i class="fas fa-step-forward fa-lg"></i>
      </button>
    </div>

    <div class="progress-section">
      <div class="progress-container">
        <input type="range" class="seek-slider" min="0" max="100" value="0">
      </div>
      <div class="time-info">
        <span class="current-time">0:00</span>
        <span class="total-time">0:00</span>
      </div>
    </div>

    <div class="volume-section">
      <i class="fas fa-volume-down"></i>
      <input type="range" class="volume-slider" min="0" max="100" value="80">
      <i class="fas fa-volume-up"></i>
    </div>

    <div class="file-upload">
      <input type="file" class="file-input" accept="audio/*" multiple>
      <div class="upload-btn">
        <i class="fas fa-cloud-upload-alt"></i>
        <span>Add music files</span>
      </div>
    </div>

    <div class="playlist">
      <div class="empty-state">
        <i class="fas fa-music"></i>
        <p>Your playlist is empty</p>
        <small>Add some music files to get started</small>
      </div>
    </div>

    <div class="visualizer"></div>
  </div>

  <script>
    class MusicPlayer {
      constructor() {
        this.initializeElements();
        this.initializeState();
        this.loadDefaultTracks();
        this.bindEvents();
      }

      initializeElements() {
        this.nowPlaying = document.querySelector('.now-playing');
        this.trackArt = document.querySelector('.track-art');
        this.trackName = document.querySelector('.track-name');
        this.trackArtist = document.querySelector('.track-artist');
        this.playPauseBtn = document.querySelector('.play-pause');
        this.prevBtn = document.querySelector('.prev-btn');
        this.nextBtn = document.querySelector('.next-btn');
        this.seekSlider = document.querySelector('.seek-slider');
        this.volumeSlider = document.querySelector('.volume-slider');
        this.currentTime = document.querySelector('.current-time');
        this.totalTime = document.querySelector('.total-time');
        this.fileInput = document.querySelector('.file-input');
        this.uploadBtn = document.querySelector('.upload-btn');
        this.playlist = document.querySelector('.playlist');
        this.visualizer = document.querySelector('.visualizer');
        this.playerContainer = document.querySelector('.player-container');
      }

      initializeState() {
        this.currentTrack = new Audio();
        this.trackIndex = 0;
        this.isPlaying = false;
        this.tracks = [];
        this.updateTimer = null;
      }

      loadDefaultTracks() {
        this.tracks = [
          {
            name: "Night Owl",
            artist: "Broke For Free",
            image: "https://picsum.photos/id/1015/400/400",
            path: "https://files.freemusicarchive.org/storage-freemusicarchive-org/music/WFMU/Broke_For_Free/Directionless_EP/Broke_For_Free_-_01_-_Night_Owl.mp3",
            bg: "linear-gradient(135deg, #667eea 0%, #764ba2 100%)"
          },
          {
            name: "Enthusiast",
            artist: "Tours",
            image: "https://picsum.photos/id/1027/400/400",
            path: "https://files.freemusicarchive.org/storage-freemusicarchive-org/music/no_curator/Tours/Enthusiast/Tours_-_01_-_Enthusiast.mp3",
            bg: "linear-gradient(135deg, #f093fb 0%, #f5576c 100%)"
          },
          {
            name: "Shipping Lanes",
            artist: "Chad Crouch",
            image: "https://picsum.photos/id/1039/400/400",
            path: "https://files.freemusicarchive.org/storage-freemusicarchive-org/music/ccCommunity/Chad_Crouch/Arps/Chad_Crouch_-_Shipping_Lanes.mp3",
            bg: "linear-gradient(135deg, #4facfe 0%, #00f2fe 100%)"
          }
        ];
        this.updatePlaylist();
        this.loadTrack(0);
      }

      bindEvents() {
        this.playPauseBtn.addEventListener('click', () => this.togglePlayPause());
        this.prevBtn.addEventListener('click', () => this.previousTrack());
        this.nextBtn.addEventListener('click', () => this.nextTrack());
        this.seekSlider.addEventListener('input', () => this.seekTo());
        this.volumeSlider.addEventListener('input', () => this.setVolume());
        this.uploadBtn.addEventListener('click', () => this.fileInput.click());
        this.fileInput.addEventListener('change', (e) => this.handleFiles(e.target.files));

        // Drag and drop
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
          this.uploadBtn.addEventListener(eventName, (e) => e.preventDefault());
        });

        this.uploadBtn.addEventListener('dragenter', () => this.uploadBtn.classList.add('dragover'));
        this.uploadBtn.addEventListener('dragover', () => this.uploadBtn.classList.add('dragover'));
        this.uploadBtn.addEventListener('dragleave', () => this.uploadBtn.classList.remove('dragover'));
        this.uploadBtn.addEventListener('drop', (e) => {
          this.uploadBtn.classList.remove('dragover');
          this.handleFiles(e.dataTransfer.files);
        });

        // Audio events
        this.currentTrack.addEventListener('loadstart', () => this.playerContainer.classList.add('loading'));
        this.currentTrack.addEventListener('loadeddata', () => this.playerContainer.classList.remove('loading'));
        this.currentTrack.addEventListener('ended', () => this.nextTrack());
        this.currentTrack.addEventListener('timeupdate', () => this.updateProgress());
      }

      loadTrack(index) {
        if (index < 0 || index >= this.tracks.length) return;

        this.trackIndex = index;
        const track = this.tracks[index];

        clearInterval(this.updateTimer);
        this.currentTrack.src = track.path;
        this.currentTrack.load();

        this.trackArt.style.backgroundImage = `url(${track.image})`;
        this.trackName.textContent = track.name;
        this.trackArtist.textContent = track.artist || 'Unknown Artist';
        this.nowPlaying.textContent = `Playing ${index + 1} of ${this.tracks.length}`;

        document.body.style.background = track.bg || 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';

        this.updatePlaylist();
        this.resetProgress();
        this.setVolume();
      }

      togglePlayPause() {
        if (this.tracks.length === 0) return;

        if (this.isPlaying) {
          this.pause();
        } else {
          this.play();
        }
      }

      play() {
        if (this.tracks.length === 0) return;
        
        this.currentTrack.play();
        this.isPlaying = true;
        this.playPauseBtn.innerHTML = '<i class="fas fa-pause fa-xl"></i>';
        this.visualizer.classList.add('playing');
      }

      pause() {
        this.currentTrack.pause();
        this.isPlaying = false;
        this.playPauseBtn.innerHTML = '<i class="fas fa-play fa-xl"></i>';
        this.visualizer.classList.remove('playing');
      }

      nextTrack() {
        if (this.tracks.length === 0) return;
        this.trackIndex = (this.trackIndex + 1) % this.tracks.length;
        this.loadTrack(this.trackIndex);
        if (this.isPlaying) this.play();
      }

      previousTrack() {
        if (this.tracks.length === 0) return;
        this.trackIndex = (this.trackIndex - 1 + this.tracks.length) % this.tracks.length;
        this.loadTrack(this.trackIndex);
        if (this.isPlaying) this.play();
      }

      seekTo() {
        const duration = this.currentTrack.duration;
        if (!isNaN(duration)) {
          this.currentTrack.currentTime = (this.seekSlider.value / 100) * duration;
        }
      }

      setVolume() {
        this.currentTrack.volume = this.volumeSlider.value / 100;
      }

      updateProgress() {
        const duration = this.currentTrack.duration;
        const currentTime = this.currentTrack.currentTime;

        if (!isNaN(duration)) {
          const progress = (currentTime / duration) * 100;
          this.seekSlider.value = progress;

          this.currentTime.textContent = this.formatTime(currentTime);
          this.totalTime.textContent = this.formatTime(duration);
        }
      }

      resetProgress() {
        this.seekSlider.value = 0;
        this.currentTime.textContent = '0:00';
        this.totalTime.textContent = '0:00';
      }

      formatTime(seconds) {
        const mins = Math.floor(seconds / 60);
        const secs = Math.floor(seconds % 60);
        return `${mins}:${secs.toString().padStart(2, '0')}`;
      }

      handleFiles(files) {
        Array.from(files).forEach(file => {
          if (file.type.startsWith('audio/')) {
            const url = URL.createObjectURL(file);
            this.tracks.push({
              name: file.name.replace(/\.[^/.]+$/, ''),
              artist: 'Local File',
              image: 'https://via.placeholder.com/400x400/667eea/ffffff?text=♪',
              path: url,
              bg: 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)',
              isLocal: true,
              objectUrl: url
            });
          }
        });

        this.updatePlaylist();
        if (this.tracks.length === 1) {
          this.loadTrack(0);
        }
      }

      updatePlaylist() {
        if (this.tracks.length === 0) {
          this.playlist.innerHTML = `
            <div class="empty-state">
              <i class="fas fa-music"></i>
              <p>Your playlist is empty</p>
              <small>Add some music files to get started</small>
            </div>
          `;
          return;
        }

        this.playlist.innerHTML = this.tracks.map((track, index) => `
          <div class="playlist-item ${index === this.trackIndex ? 'active' : ''}" data-index="${index}">
            <div class="track-info-mini">
              <div class="track-title">${track.name}</div>
              <div class="track-artist-mini">${track.artist}</div>
            </div>
            <div class="playlist-controls">
              <button class="playlist-btn play-btn" data-index="${index}" title="Play">
                <i class="fas fa-play"></i>
              </button>
              <button class="playlist-btn remove-btn" data-index="${index}" title="Remove">
                <i class="fas fa-times"></i>
              </button>
            </div>
          </div>
        `).join('');

        // Bind playlist events
        this.playlist.querySelectorAll('.playlist-item').forEach(item => {
          item.addEventListener('click', (e) => {
            if (!e.target.closest('.playlist-controls')) {
              const index = parseInt(item.dataset.index);
              this.loadTrack(index);
              this.play();
            }
          });
        });

        this.playlist.querySelectorAll('.play-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            const index = parseInt(btn.dataset.index);
            this.loadTrack(index);
            this.play();
          });
        });

        this.playlist.querySelectorAll('.remove-btn').forEach(btn => {
          btn.addEventListener('click', (e) => {
            e.stopPropagation();
            this.removeTrack(parseInt(btn.dataset.index));
          });
        });
      }

      removeTrack(index) {
        if (index < 0 || index >= this.tracks.length) return;

        const removedTrack = this.tracks[index];
        if (removedTrack.isLocal && removedTrack.objectUrl) {
          URL.revokeObjectURL(removedTrack.objectUrl);
        }

        this.tracks.splice(index, 1);

        if (this.tracks.length === 0) {
          this.pause();
          this.resetProgress();
          this.trackName.textContent = 'Select a track to play';
          this.trackArtist.textContent = 'No artist';
          this.nowPlaying.textContent = 'No tracks';
          this.trackArt.style.backgroundImage = '';
          document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)';
        } else {
          if (index === this.trackIndex) {
            this.trackIndex = Math.min(this.trackIndex, this.tracks.length - 1);
            this.loadTrack(this.trackIndex);
          } else if (index < this.trackIndex) {
            this.trackIndex--;
          }
        }

        this.updatePlaylist();
      }
    }

    // Initialize the music player
    const player = new MusicPlayer();

    // Cleanup on page unload
    window.addEventListener('beforeunload', () => {
      player.tracks.forEach(track => {
        if (track.isLocal && track.objectUrl) {
          URL.revokeObjectURL(track.objectUrl);
        }
      });
    });
  </script>
</body>
</html>





